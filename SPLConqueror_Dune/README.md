# DuneAnalyzer

<details><summary>Running DuneAnalyzer</summary>
<p>
To run DuneAnalyzer compile the project and execute:

```
DuneAnalyzer.exe <pathToStarterFile.txt>
```

</p>
</details>

<details><summary>Annotated Source Code</summary>
<p>
To annotate a variation point  <br>

```
LoopSolver<Vector> x;
```

<br> in the source code of a project simply add a comment line <br>

```
//VARIATIONPOINT(SOLVER; a; Dune::LoopSolver<Vector>;)
```

<br>

```
 LoopSolver<Vector> a;
```

<br>, where first argument of `VARIATIONPOINT` denotes the name you want to assign to the variation point, the second the name of the variation point in the source code and the third the template you want to find alternatives for. <br>
The result - after running DuneAnalyzer - should then look similar to this
<br>

```
//VARIATIONPOINT(SOLVER; a; Dune::LoopSolver<Vector>;)
```

<br>

```
 SOLVER_VarPoint_97 a;
```

 .<br>
 It is possible to add as many variation points to your code as you want.
</p>
</details>

<details><summary>Content of Starter File</summary>
<p>
Here we lay out the contents of the Starter File that is used to run DuneAnalyzer.<br>
Each setting is seperated by a linebreak and key and values are seperated by whitespaces.<br><br>
Required settings:<br>

* `XML_PATH`: Absolute path to a xml documentation generated by Doxygen.

* `DEBUG_PATH`: Absolute path to a folder. Debug information will be printed in this folder.

* `BASE_DIR_DUNE_APPLICATION`: Absolute path to the base directory of the project that should be analyzed. The path should end with `/` or `\` depending on your operating system.

* `MAIN_FILE_DUNE_APPLICATION`: Path the annotated source code file relatively from `BASE_DIR_DUNE_APPLICATION`.

* `BASE_DIR_DUNE_APPLICATION_MINI_VERSION`: Absolute path to the directory used to output the generated project.

* `RESULT_DIR`: Absolute path where additional results are saved such as a `.mini` file that also contains templates that could not properly be resolved.

* `MINI_FILE_LOCATION`: Absolute path to the `.mini` file that will be generated for this project.

* `NEW_C_MAKE_LISTS`: Path to the `CMakeLists.txt` file that will be generated for support of `dune-testtools`. Should usually be in the same folder as the source code file.


<br>
Optional settings:<br>

* `CONSTRAINT_FILE`: Absolute path the `.txt` containing constraints.(TBD: Constraint definitions).

* `REPLACE_UNKNOWN_CLASSES_METHOD_WILDCARD`: `true` or `false`. Enables/Disables more coarse search when comparing templates by replacing template arguments with wildcards.

* `REPLACE_UNKNOWN_CLASSES_TEMPLATE_WILDCARD`: `true` or `false`. Enables/Disables more coarse search when comparing methods by replacing method arguments with wildcards.

* `USE_INTERACTIVE_SHELL`: `true` or `false`. Enables/Disables interactive shell to alter the mini file that will be generated by e.g. adding new default input for variation points.

</p>
</details>

<details><summary>Interactive Shell</summary>
<p>
If the interactive shell is enable you can execute the following commands:<br>

* `print [--filtered/--all] <VARIATIONPOINT_NAME>`: Prints the results of the analysis. With the `--filtered` switch only templates that could be fully resolved will be printed, while `--all` prints all template alternatives that were found. Optionally, the output can be limited to a single variation point by providing the name of the variation point as second arguments(Note: This is case sensitive).<br>

* `rename [VARIATIONPOINT_NAME] [OLD] [NEW]`: With the `rename` template arguments can be renamed for a certain given variation point. For this the old name and the new name need to be provided. To delete an argument the `_` can be used as the new value.<br>

* `save [--all/--filtered]`: Save the filtered/unfiltered results to the mini file defined in the starter file.<br>

* `delete [VARIATIONPOINT_NAME] [int]`: Delete the alternative from a varation point at the given index. Note that the indices of the unfiltered output are used.<br>

* `change [VARIATIONPOINT_NAME] [TEMPLATE]`: Changes the template that is used to search alternatives at a given variation point and search for new alternatives. Previous results will be deleted.<br>

* `add [VARIATIONPOINT_NAME] [TEMPLATE]`: Add the alternatives of a given template to the given variation point.<br>

* `quit`: Quits DuneAnalyzer.<br>

</p>
</details>
